<div style="margin-top: 60px" >
  <div style="display: flex; justify-content: space-between">
    <span class="user">
      Author: <%= link_to micropost.user.name, micropost.user %>
    </span>
      <span class="micropost-content">
      <% if current_user?(micropost.user) %>
        <%= link_to "delete post", micropost, data: {turbo_method: :delete,  turbo_confirm: "You sure?" } %>
      <% end %>
    </span>
  </div>
  <p class="content micropost-content">
    <%= micropost.content %>
  </p>
  <div style="width: 100px">
    <%= image_tag micropost.image if micropost.image.attached? %>
  </div>
  <p class="timestamp" style="float: right">
    Posted <%= time_ago_in_words(micropost.created_at) %> ago.
  </p>
  <div style="margin: 20px">
    <%= render "shared/comment_form" %>
  </div>
  <div style="margin: 20px">
    <div id="microposts">
      <div id="microposts_<%= micropost.id %>"></div>
      <% micropost.comments.each do |comment| %>
        <%= render "shared/comment", micropost: comment %>
      <% end %>
    </div>
  </div>
</div>


<script type="text/javascript">
    document.addEventListener("turbo:load", function() {
        initializeCommentForm();
    });
    function initializeCommentForm() {
        let form = document.getElementById("comment-form");
        let textarea = document.getElementById("input-comment");
        if (form && textarea) {
            form.addEventListener("turbo:submit-end", (event) => {
                if (event.detail.success) {
                    textarea.value = ''
                }
            });
        }
    }
</script>

